<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ì§€í›ˆ & ìˆ˜ì§„ì˜ ê²°í˜¼ì‹</title>
    
    <link rel="manifest" href="manifest.json">
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/2448/2448528.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* ì„¹ì…˜ ì´ë™ ì‹œ ë¶€ë“œëŸ¬ìš´ ìŠ¤í¬ë¡¤ íš¨ê³¼ ì¶”ê°€ */
        html {
            scroll-behavior: smooth;
        }
        
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@400;700&family=Noto+Sans+KR:wght@300;400;700&display=swap');
        
        body {
            /* ê³ ì • í•˜ë‹¨ ë©”ë‰´ ê³µê°„ í™•ë³´ë¥¼ ìœ„í•´ pb-20ì„ pb-28ë¡œ ì„¤ì • */
            padding-bottom: 7rem; 
            font-family: 'Noto Sans KR', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        .serif {
            font-family: 'Noto Serif KR', serif;
        }
        .animate-fade-in {
            animation: fadeIn 1.5s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .map-btn {
            transition: transform 0.1s;
        }
        .map-btn:active {
            transform: scale(0.95);
        }
        /* ì•Œë¦¼ ì„¤ì • ì‹œ ë²„íŠ¼ ë””ìì¸ ë³€ê²½ */
        #noti-btn[data-state="set"] {
            background-color: #fce7f3; /* pink-100 */
        }
        #noti-btn[data-state="set"] .fa-bell {
            color: #ec4899; /* pink-500 */
        }
    </style>
</head>
<body class="bg-stone-50 text-stone-800 pb-28"> 

    <header class="relative h-screen max-h-[600px] w-full overflow-hidden">
        <img src="https://images.unsplash.com/photo-1519741497674-611481863552?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" 
             class="absolute w-full h-full object-cover brightness-75" alt="Wedding Background">
        
        <div class="absolute inset-0 flex flex-col items-center justify-center text-white text-center p-4 animate-fade-in">
            <p class="text-lg mb-2 tracking-widest">WE ARE GETTING MARRIED</p>
            <h1 class="text-4xl font-bold mb-4 serif">ì§€í›ˆ <span class="text-pink-200">&</span> ìˆ˜ì§„</h1>
            <div class="w-12 h-0.5 bg-white mb-4"></div>
            <p id="d-day" class="text-xl font-light mb-6">D-30</p>
            <p class="text-sm opacity-90">2025ë…„ 12ì›” 25ì¼ í† ìš”ì¼ ì˜¤í›„ 2ì‹œ</p>
            <p class="text-sm opacity-90">ë¶€ì‚° ë™ì˜ê³¼í•™ ì›¨ë”©í™€</p>
        </div>
    </header>

    <main class="max-w-md mx-auto px-6 -mt-10 relative z-10">
        
        <div id="installBanner" class="hidden bg-white p-4 rounded-xl shadow-lg mb-6 flex items-center justify-between border border-pink-100">
            <div class="flex items-center gap-3">
                <img src="https://cdn-icons-png.flaticon.com/512/2448/2448528.png" class="w-10 h-10 rounded-lg bg-pink-50 p-1">
                <div class="text-sm">
                    <p class="font-bold">ì•±ìœ¼ë¡œ ë³´ê¸°</p>
                    <p class="text-gray-500 text-xs">ê²°í˜¼ì‹ ì´ˆëŒ€ì¥ ì•±ì„ ì„¤ì¹˜í•˜ì—¬ ì´ìš©í•´ì£¼ì„¸ìš”!</p>
                </div>
            </div>
            <button onclick="installPWA()" class="bg-pink-500 text-white text-xs px-3 py-2 rounded-lg font-bold hover:bg-pink-600">
                ì•± ì„¤ì¹˜
            </button>
        </div>
        
        <div id="invitation-section" class="bg-white p-8 rounded-t-xl shadow-sm text-center">
            <i class="fa-solid fa-quote-left text-pink-200 text-2xl mb-4"></i>
            <p class="text-sm leading-7 text-gray-600 mb-6 serif">
                ì„œë¡œì˜ ì´ë¦„ì„ ë¶€ë¥´ëŠ” ê²ƒë§Œìœ¼ë¡œ<br>
                ì„œë¡œì—ê²Œ ìœ„ë¡œê°€ ë˜ëŠ” ì‚¬ë‘ì„ ì‹œì‘í•©ë‹ˆë‹¤.<br>
                ë³€ì¹˜ ì•ŠëŠ” ë§ˆìŒìœ¼ë¡œ<br>
                ì•„ë¦„ë‹¤ìš´ ê°€ì •ì„ ì´ë£¨ê² ìŠµë‹ˆë‹¤.
            </p>
            <i class="fa-solid fa-quote-right text-pink-200 text-2xl mb-6"></i>
            
            <div class="flex justify-center space-x-8 mt-4 mb-8">
                <div>
                    <span class="text-gray-400 text-xs block mb-1">GROOM</span>
                    <strong class="serif">ê¹€ì§€í›ˆ</strong>
                    <a href="tel:010-0000-1234" class="text-pink-500 ml-2">
                        <i class="fa-solid fa-phone text-sm"></i>
                    </a>
                </div>
                <div>
                    <span class="text-gray-400 text-xs block mb-1">BRIDE</span>
                    <strong class="serif">ì´ìˆ˜ì§„</strong>
                    <a href="tel:010-0000-5678" class="text-pink-500 ml-2">
                        <i class="fa-solid fa-phone text-sm"></i>
                    </a>
                </div>
            </div>
        </div>

        <div id="app-features-section" class="bg-white p-6 mt-2 shadow-sm">
            <h3 class="text-center font-bold text-lg mb-4 serif">ìŠ¤ë§ˆíŠ¸ í¸ì˜ ê¸°ëŠ¥</h3>
            <div class="grid grid-cols-2 gap-4"> 
                <button onclick="toggleNotification()" id="noti-btn" data-state="unset" class="bg-white p-4 rounded-xl shadow-md flex flex-col items-center justify-center transition-all duration-300 border border-pink-100">
                    <i class="fa-solid fa-bell text-xl text-pink-500 mb-2"></i>
                    <span class="font-bold text-sm">ê²°í˜¼ì‹ ì•Œë¦¼ ì„¤ì •</span>
                    <span id="noti-status" class="text-xs text-gray-500 mt-1">ì›í•˜ëŠ” ì‹œê°„ìœ¼ë¡œ ì•Œë¦¼ ì˜ˆì•½</span>
                </button>
                <button onclick="scanQR()" class="bg-white p-4 rounded-xl shadow-md flex flex-col items-center justify-center border border-pink-100">
                    <i class="fa-solid fa-qrcode text-xl text-pink-500 mb-2"></i>
                    <span class="font-bold text-sm">ì‹ê¶Œ QR ìŠ¤ìº”</span>
                    <span class="text-xs text-gray-500 mt-1">ì°¸ì„ í™•ì¸ (ì•± ì „ìš©)</span>
                </button>
            </div>
        </div>

        <div id="gallery-section" class="bg-white p-6 mt-2 shadow-sm">
            <h3 class="text-center font-bold text-lg mb-4 serif">ê°¤ëŸ¬ë¦¬</h3>
            <div class="grid grid-cols-2 gap-2">
                <img src="img1.jpg" class="w-full h-auto rounded shadow-md" alt="ì‚¬ì§„ 1">
                <img src="img2.jpg" class="w-full h-auto rounded shadow-md" alt="ì‚¬ì§„ 2">
                <img src="img3.jpg" class="w-full h-auto rounded shadow-md" alt="ì‚¬ì§„ 3">
                <img src="img4.jpg" class="w-full h-auto rounded shadow-md" alt="ì‚¬ì§„ 4">
            </div>
        </div>

        <div id="location-section" class="bg-white p-6 mt-2 shadow-sm">
            <h3 class="text-center font-bold text-lg mb-4 serif">ì˜¤ì‹œëŠ” ê¸¸</h3>
            <p class="text-sm text-center mb-2">ë¶€ì‚° ë™ì˜ê³¼í•™ ì›¨ë”©í™€ 1ì¸µ</p>

            <div id="map-area" class="w-full h-48 rounded-lg mb-4 overflow-hidden shadow-inner bg-gray-100 relative">
                <img src="map.png" class="w-full h-full object-cover" alt="ì˜ˆì‹ì¥ ì•½ë„">
                <div class="absolute bottom-0 left-0 w-full bg-black/50 text-white text-xs p-2 text-center backdrop-blur-sm">
                    ë¶€ì‚°ê´‘ì—­ì‹œ ë¶€ì‚°ì§„êµ¬ ì–‘ì§€ë¡œ 54
                </div>
            </div>

            <div class="grid grid-cols-3 gap-2">
                <button onclick="openMap('naver')" class="map-btn py-2 bg-[#03C75A] text-white text-xs rounded font-bold">
                    ë„¤ì´ë²„ ì§€ë„
                </button>
                <button onclick="openMap('kakao')" class="map-btn py-2 bg-[#FEE500] text-stone-800 text-xs rounded font-bold">
                    ì¹´ì¹´ì˜¤ ì§€ë„
                </button>
                <button onclick="openMap('google')" class="map-btn py-2 bg-gray-100 border border-gray-300 text-gray-700 text-xs rounded font-bold">
                    êµ¬ê¸€ ì§€ë„
                </button>
            </div>
        </div>

    </main>
    
    <nav class="fixed bottom-0 left-0 right-0 max-w-md mx-auto z-50 bg-white border-t border-pink-100 shadow-xl">
        <div class="flex justify-around items-center h-16">
            <a href="#invitation-section" class="text-center text-pink-500 hover:text-pink-600 transition-colors flex flex-col items-center">
                <i class="fa-solid fa-envelope-open-text text-xl"></i>
                <span class="text-xs mt-1">ì´ˆëŒ€ê¸€</span>
            </a>
            <a href="#app-features-section" class="text-center text-pink-500 hover:text-pink-600 transition-colors flex flex-col items-center">
                <i class="fa-solid fa-mobile-screen text-xl"></i>
                <span class="text-xs mt-1">í¸ì˜ ê¸°ëŠ¥</span>
            </a>
            <a href="#gallery-section" class="text-center text-pink-500 hover:text-pink-600 transition-colors flex flex-col items-center">
                <i class="fa-solid fa-camera-retro text-xl"></i>
                <span class="text-xs mt-1">ê°¤ëŸ¬ë¦¬</span>
            </a>
            <a href="#location-section" class="text-center text-pink-500 hover:text-pink-600 transition-colors flex flex-col items-center">
                <i class="fa-solid fa-map-location-dot text-xl"></i>
                <span class="text-xs mt-1">ì˜¤ì‹œëŠ” ê¸¸</span>
            </a>
        </div>
    </nav>

    <footer class="text-center text-xs text-gray-400 mt-10">
        Â© 2025 Jihun & Sujin Wedding Invitation.
    </footer>

    <script src="cordova.js"></script>

    <script>
        // --- í•˜ì´ë¸Œë¦¬ë“œ ì•± ë¶„ê¸° ì²˜ë¦¬ë¥¼ ìœ„í•œ ë³€ìˆ˜ ---
        const isCordova = !!window.cordova;
        let deferredPrompt = null;
        const WEDDING_DATE = new Date('2025-12-25T14:00:00'); // ê²°í˜¼ì‹ ë‚ ì§œ ë° ì‹œê°„
        const NOTIFICATION_ID = 1; // ì•Œë¦¼ ID
        // APK ë‹¤ìš´ë¡œë“œ ë§í¬ë¥¼ ìƒìˆ˜ë¡œ ì •ì˜
        const APK_URL = 'https://drive.google.com/uc?export=download&id=1wsZvcaa_xrTB78DvR6unptzEmcuVSl-h'; 

        // --- D-Day ê³„ì‚° ë¡œì§ ---
        function updateDDay() {
            const now = new Date();
            const timeDiff = WEDDING_DATE.getTime() - now.getTime();
            const days = Math.ceil(timeDiff / (1000 * 60 * 60 * 24));
            
            const dDayElement = document.getElementById('d-day');
            
            if (days > 0) {
                dDayElement.textContent = `D-${days}`;
            } else if (days === 0) {
                dDayElement.textContent = `D-Day`;
            } else {
                dDayElement.textContent = `ê²°í˜¼ ${Math.abs(days)}ì¼ì§¸ í–‰ë³µ ì¤‘!`;
            }
        }
        updateDDay();
        setInterval(updateDDay, 1000 * 60 * 60); // 1ì‹œê°„ë§ˆë‹¤ ì—…ë°ì´íŠ¸

        // --- PWA/APK í†µí•© ì„¤ì¹˜ ë¡œì§ (ì›¹ì—ì„œë§Œ ì‘ë™) ---
        const installBanner = document.getElementById('installBanner');
        window.addEventListener('beforeinstallprompt', (e) => {
            // beforeinstallprompt ì´ë²¤íŠ¸ ë°œìƒ ì‹œ deferredPromptë§Œ ì €ì¥í•©ë‹ˆë‹¤.
            deferredPrompt = e;
        });

        function installPWA() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    deferredPrompt = null;
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the install prompt (PWA)');
                        installBanner.classList.add('hidden');
                    } else {
                        // PWA ì„¤ì¹˜ë¥¼ ê±°ë¶€/ë‹«ìœ¼ë©´ APK ë‹¤ìš´ë¡œë“œë¥¼ ìœ ë„
                        console.log('User dismissed PWA prompt. Initiating APK download.');
                        alert("PWA ì„¤ì¹˜ë¥¼ ê±´ë„ˆë›°ì…¨ìŠµë‹ˆë‹¤. í’€ ê¸°ëŠ¥ ì‚¬ìš©ì„ ìœ„í•´ ì•ˆë“œë¡œì´ë“œ ì•± ë‹¤ìš´ë¡œë“œë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.");
                        window.open(APK_URL, '_system');
                        installBanner.classList.add('hidden'); // ë‹¤ìš´ë¡œë“œ ì‹œì‘ í›„ì—ë„ ìˆ¨ê¹€
                    }
                });
            } else {
                // PWAê°€ ì§€ì›ë˜ì§€ ì•Šê±°ë‚˜ ì´ë¯¸ ì„¤ì¹˜ëœ ê²½ìš° (PWAë¥¼ ë°”ë¡œ ì„¤ì¹˜í•  ìˆ˜ ì—†ëŠ” ê²½ìš°)
                alert("ì•± ì„¤ì¹˜ ì˜µì…˜ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì•ˆë“œë¡œì´ë“œ ì•± ë‹¤ìš´ë¡œë“œë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.");
                window.open(APK_URL, '_system');
                installBanner.classList.add('hidden');
            }
        }

        // --- ì§€ë„ ë§í¬ ë¡œì§ ---
        function openMap(type) {
            let url;
            // ì‹¤ì œ ì˜ˆì‹ì¥ ìœ„ì¹˜ URLì„ ì—¬ê¸°ì— ë„£ì–´ì£¼ì„¸ìš”
            const locationName = 'ë¶€ì‚°ë™ì˜ê³¼í•™ëŒ€í•™êµì»¨ë²¤ì…˜í™€';
            const locationLat = '35.1764'; 
            const locationLng = '129.0768';
            
            if (type === 'naver') {
                // ë„¤ì´ë²„ ì§€ë„ ì•±/ì›¹ ì—°ê²°
                url = `https://naver.me/FBe8e2lR`;
            } else if (type === 'kakao') {
                // ì¹´ì¹´ì˜¤ ì§€ë„ ì•±/ì›¹ ì—°ê²°
                url = `https://kko.kakao.com/VbuHOo2YDG`;
            } else if (type === 'google') {
                // êµ¬ê¸€ ì§€ë„ ì•±/ì›¹ ì—°ê²°
                url = `https://maps.app.goo.gl/0`; 
            }

            // Cordova ì•±ì´ë¼ë©´ _systemìœ¼ë¡œ ì™¸ë¶€ ì•±ì„ ì—´ê³ , ì›¹ì´ë¼ë©´ _blankë¡œ ìƒˆ íƒ­ì„ ì—½ë‹ˆë‹¤.
            window.open(url, isCordova ? '_system' : '_blank');
        }

        // --- ì•Œë¦¼ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ ---
        function updateNotificationButton(isScheduled, scheduledTime = null) {
            const btn = document.getElementById('noti-btn');
            const statusText = document.getElementById('noti-status');
            const boldText = btn.querySelector('.font-bold');

            if (isScheduled) {
                // ì˜ˆì•½ë¨ ìƒíƒœ
                btn.setAttribute('data-state', 'set');
                const timeStr = scheduledTime ? `${scheduledTime.getMonth() + 1}ì›” ${scheduledTime.getDate()}ì¼ ${scheduledTime.getHours()}ì‹œ ${scheduledTime.getMinutes().toString().padStart(2, '0')}ë¶„` : 'ì‹œê°„ ë¯¸ì •';
                boldText.textContent = 'ì•Œë¦¼ ì·¨ì†Œ';
                statusText.textContent = `ğŸ”” ${timeStr}ì— ì•Œë¦¼ ì˜ˆì•½ë¨`;
            } else {
                // ì˜ˆì•½ë˜ì§€ ì•ŠìŒ ìƒíƒœ
                btn.setAttribute('data-state', 'unset');
                boldText.textContent = 'ê²°í˜¼ì‹ ì•Œë¦¼ ì„¤ì •'; // í…ìŠ¤íŠ¸ë¥¼ ë” ëª…í™•í•˜ê²Œ ë³€ê²½
                statusText.textContent = isCordova ? 'ì›í•˜ëŠ” ì‹œê°„ìœ¼ë¡œ ì•Œë¦¼ ì˜ˆì•½' : 'ì•± ì„¤ì¹˜ í›„ ì‚¬ìš© ê°€ëŠ¥'; // í…ìŠ¤íŠ¸ë¥¼ ë” ëª…í™•í•˜ê²Œ ë³€ê²½
            }
        }

        // --- ì•Œë¦¼ ì„¤ì • ë° ì·¨ì†Œ ë¡œì§ (Date Picker ì‚¬ìš©) ---
        function toggleNotification() {
            if (!isCordova) {
                alert("ì´ ê¸°ëŠ¥ì€ ì•± ì„¤ì¹˜(Cordova) í›„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\ní’€ ê¸°ëŠ¥ ì•±ì„ ì„¤ì¹˜í•´ ì£¼ì„¸ìš”.");
                return;
            }

            const localNotification = window.cordova.plugins.notification.local;
            
            // 1. ì˜ˆì•½ëœ ì•Œë¦¼ì´ ìˆëŠ”ì§€ í™•ì¸í•˜ê³  ì·¨ì†Œ ì²˜ë¦¬
            localNotification.isScheduled(NOTIFICATION_ID, function(isScheduled) {
                if (isScheduled) {
                    localNotification.cancel(NOTIFICATION_ID, function() {
                        updateNotificationButton(false);
                        alert("ê²°í˜¼ì‹ ì•Œë¦¼ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.");
                    });
                    return;
                }

                // 2. ì˜ˆì•½ëœ ì•Œë¦¼ì´ ì—†ë‹¤ë©´ Date Pickerë¥¼ ë„ì›Œì„œ ì‹œê°„ ì„¤ì •
                window.datePicker.show({
                    date: WEDDING_DATE,
                    mode: 'datetime',
                    androidTheme: window.datePicker.ANDROID_THEMES.THEME_DEVICE_DEFAULT_LIGHT
                }, function(selectedTime) {
                    if (selectedTime instanceof Date) {
                        // ì„ íƒëœ ì‹œê°„ì´ í˜„ì¬ ì‹œê°„ë³´ë‹¤ ì´ì „ì´ë¼ë©´ ì•Œë¦¼ì„ ì„¤ì •í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
                        if (selectedTime.getTime() < new Date().getTime()) {
                            alert("ì„ íƒí•œ ì‹œê°„ì´ í˜„ì¬ë³´ë‹¤ ì´ì „ì…ë‹ˆë‹¤. ë¯¸ë˜ ì‹œê°„ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.");
                            return;
                        }

                        // ì•Œë¦¼ ì˜ˆì•½
                        localNotification.schedule({
                            id: NOTIFICATION_ID,
                            title: "ğŸ¤µğŸ»ğŸ‘°ğŸ» ì§€í›ˆ & ìˆ˜ì§„ ê²°í˜¼ì‹ ë¦¬ë§ˆì¸ë”",
                            text: "ê³§ ê²°í˜¼ì‹ì´ ì‹œì‘ë©ë‹ˆë‹¤! ìŠì§€ ë§ˆì„¸ìš”!",
                            trigger: { at: selectedTime },
                            foreground: true
                        }, function() {
                            // ì˜ˆì•½ ì„±ê³µ
                            updateNotificationButton(true, selectedTime);
                            alert(`${selectedTime.getMonth() + 1}ì›” ${selectedTime.getDate()}ì¼ ${selectedTime.getHours()}ì‹œ ${selectedTime.getMinutes().toString().padStart(2, '0')}ë¶„ìœ¼ë¡œ ì•Œë¦¼ì´ ì˜ˆì•½ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                        });
                    }
                    // ì·¨ì†Œ ì‹œ ì½œë°±ì´ ì‹¤í–‰ë˜ì§€ ì•Šê±°ë‚˜, selectedTimeì´ null/undefinedì¼ ìˆ˜ ìˆìŒ
                }, function (error) {
                    console.log('Date Picker Error: ' + error);
                });
            });
        }

        // --- QR ìŠ¤ìº” / ì¹´ë©”ë¼ (Cordova Only) ---
        function scanQR() {
            if (isCordova) {
                if (!navigator.camera) {
                    alert("ì¹´ë©”ë¼ í”ŒëŸ¬ê·¸ì¸(cordova-plugin-camera)ì´ ì—†ìŠµë‹ˆë‹¤.");
                    return;
                }
                
                navigator.camera.getPicture((imageData) => {
                    // ì„±ê³µ ì‹œ: QR ì½”ë“œ ìŠ¤ìº” ì„±ê³µ ë¡œì§ ëŒ€ì‹  ì‹œë®¬ë ˆì´ì…˜
                    alert("ì‚¬ì§„ ì´¬ì˜ ì™„ë£Œ! (QR ìŠ¤ìº” ì‹œë®¬ë ˆì´ì…˜)");
                }, (err) => {
                    // ì˜¤ë¥˜ ì‹œ: ì‚¬ìš©ìê°€ ì·¨ì†Œí•˜ê±°ë‚˜ ì˜¤ë¥˜ ë°œìƒ
                    alert("ì¹´ë©”ë¼ ì‘ì—… ì·¨ì†Œ ë˜ëŠ” ì˜¤ë¥˜ ë°œìƒ.");
                    console.error("Camera Error: " + err);
                }, {
                    quality: 50,
                    destinationType: Camera.DestinationType.DATA_URL,
                    sourceType: Camera.PictureSourceType.CAMERA // ì¹´ë©”ë¼ ë°”ë¡œ ì‹¤í–‰
                });

            } else {
                alert("ì´ ê¸°ëŠ¥ì€ ì•± ì„¤ì¹˜(Cordova) í›„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\ní’€ ê¸°ëŠ¥ ì•±ì„ ì„¤ì¹˜í•´ ì£¼ì„¸ìš”.");
            }
        }

        // --- Cordova ì¤€ë¹„ ì™„ë£Œ ì´ë²¤íŠ¸ ---
        document.addEventListener('deviceready', function() {
            const localNotification = window.cordova.plugins.notification.local;
            
            if (localNotification) {
                // 1. ì•Œë¦¼ ê¶Œí•œ ìš”ì²­
                localNotification.hasPermission(function (granted) {
                    if (!granted) {
                        localNotification.requestPermission();
                    }
                });

                // 2. ì´ˆê¸° ì•Œë¦¼ ìƒíƒœ í™•ì¸ ë° ë²„íŠ¼ ì—…ë°ì´íŠ¸
                localNotification.isScheduled(NOTIFICATION_ID, function(isScheduled) {
                    if (isScheduled) {
                        localNotification.get(NOTIFICATION_ID, function(notification) {
                            const scheduledTime = notification && notification.trigger && notification.trigger.at 
                                                  ? new Date(notification.trigger.at) 
                                                  : null;
                            updateNotificationButton(true, scheduledTime);
                        });
                    } else {
                        updateNotificationButton(false);
                    }
                });
            } else {
                // ì›¹ í™˜ê²½ (Cordova Readyê°€ ì•ˆ ë¨)ì—ì„œë„ ë²„íŠ¼ ìƒíƒœë¥¼ 'ì•± ì„¤ì¹˜ í›„ ì‚¬ìš© ê°€ëŠ¥'ìœ¼ë¡œ ì—…ë°ì´íŠ¸
                updateNotificationButton(false); 
            }
        }, false);
        
        // --- Service Worker ë“±ë¡ (PWA í•„ìˆ˜) ---
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js')
                    .then(reg => console.log('SW registered:', reg))
                    .catch(err => console.log('SW failed:', err));
            });
        }
        
        // ì‚¬ìš©ì ìš”ì²­ ë°˜ì˜: Cordova ì•±ì´ ì•„ë‹ˆë©´ (PC ì›¹, ëª¨ë°”ì¼ ì›¹) beforeinstallprompt ì´ë²¤íŠ¸ì™€ 
        // ê´€ê³„ì—†ì´ ë°°ë„ˆë¥¼ ë¬´ì¡°ê±´ í‘œì‹œí•©ë‹ˆë‹¤.
        if (!isCordova && installBanner) {
            installBanner.classList.remove('hidden');
        }
    </script>
</body>
</html>
